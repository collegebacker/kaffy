<table class="table table-striped">
    <thead>
        <% index_path = Kaffy.Utils.router().kaffy_resource_path(@conn, :index, @context, @resource) %>
        <%= render KaffyWeb.ResourceView, "_table_header.html", my_resource: @my_resource, fields: @fields, params: @params, index_path: index_path, context: @context, resource: @resource %>
    </thead>

    <tbody>
        <%= for {entry, index} <- Enum.with_index(@entries) do %>
            <tr>
                <td>
                    <div class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input select-item kaffy-resource-checkbox" id="kaffy-select-<%= index %>" name="resource" value="<%= Kaffy.ResourceAdmin.serialize_id(@my_resource, entry) %>"/>
                        <label class="custom-control-label" for="kaffy-select-<%= index %>"></label>
                    </div>
                </td>
                <%= for {field, index} <- Enum.with_index(@fields) do %>
                    <% value = Kaffy.ResourceSchema.kaffy_field_value(@conn, entry, field) %>
                    <% url = Kaffy.ResourceSchema.kaffy_target_url(entry, @context, field) %>

                    <%= if url do %>
                        <td><%= link value, to: url %></td>
                    <% else %>
                        <%= if index == 0 do %>
                            <td><%= link value, to: Kaffy.Utils.router().kaffy_resource_path(@conn, :show, @context, @resource, Kaffy.ResourceAdmin.serialize_id(@my_resource, entry)) %></td>
                        <% else %>
                            <td><%= value %></td>
                        <% end %>
                    <% end %>
                <% end %>
            </tr>
        <% end %>
    </tbody>
</table>
